<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Document</title>
  <style>
    body {
      user-select: none;
      margin: 0px;
    }

    .task-board {
      width: calc(99vw - 64px);
      height: calc(99vh - 104px);
      padding-left: 64px;
      padding-top: 104px;
      display: flex;
      flex-direction: row;
      flex-wrap: nowrap;
      align-items: center;
      justify-content: flex-start;
      position: relative;
      gap: 27px;
      background-color: #ffffff;
      overflow-x: overlay;
      overflow-y: hidden;
    }

    .task-list {
      align-self: flex-start;
      width: 250px;
      height: 846px;
      border-radius: 5px;
      padding-bottom: 7px;
      display: flex;
      flex-direction: column;
      gap: 10px;
      background-color: #f5f5f5;
    }

    .task-header {
      width: 230px;
      height: 65px;
      padding: 10px;
      display: flex;
      flex-direction: column;
      gap: 12px;
      background-color: #f5f5f5;
      position: absolute;
    }

    .task-headline {
      width: 230px;
      height: 34px;
      padding: 0px;
      display: flex;
      flex-direction: row;
      flex-wrap: nowrap;
      justify-content: flex-start;
      align-items: flex-start;
      position: absolute;
      left: 10px;
      top: 10px;
    }

    .task-headline-title {
      width: 215px;
      height: 34px;
      padding: 0px;
      display: flex;
      flex-direction: row;
      justify-content: flex-start;
      align-items: flex-start;
      position: relative;
    }

    .task-headline-title-text {
      text-align: left;
      vertical-align: text-top;
      font-size: 28px;
      font-family: Inter;
      line-height: auto;
      color: #000000;
      user-select: none;
    }

    .icon-vertical-dot {
      align-self: flex-start;
      left: 215px;
      position: absolute;
      width: 15px;
      height: 27px;
      padding-left: 6px;
      padding-right: 6px;
      padding-top: 7px;
      padding-bottom: 7px;
      display: flex;
      flex-direction: column;
      gap: 2px;
      background-image: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAA8AAAAbCAYAAACjkdXHAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAA3SURBVHgB7dAxDgAgCEPR78nh5ujAiInGSdKXEJamQ0Ea8HWRvzTYi8NcybLA+Iqjwa44GkxeTSQDDvjfd6bUAAAAAElFTkSuQmCC");
      background-position: center;
      background-repeat: no-repeat;
      cursor: pointer;
    }

    .task-header-description {
      width: 230px;
      height: 19px;
      padding-left: 2px;
      padding-right: 2px;
      padding-top: 5px;
      padding-bottom: 5px;
      display: flex;
      flex-direction: row;
      flex-wrap: nowrap;
      justify-content: flex-start;
      align-items: flex-start;
      position: absolute;
      background-color: #cccccc;
      top: 56px;
      left: 10px;
    }

    .task-header-description-text {
      text-align: left;
      vertical-align: text-top;
      font-size: 16px;
      font-family: Inter;
      align-self: flex-start;
      left: 2px;
      position: absolute;
      line-height: auto;
      color: #000000;
      user-select: none;
    }

    .task-body {
      width: 237px;
      height: 758px;
      padding: 0 7px;
      display: flex;
      flex-direction: column;
      gap: 7px;
      top: 95px;
      position: relative;
      overflow: hidden;
    }

    .task-body:hover {
      width: 250px;
      overflow: overlay;
    }

    .task {
      width: 215px;
      height: 142px;
      border-radius: 5px;
      padding: 10px;
      display: flex;
      flex-direction: column;
      gap: 20px;
      background-color: #ffffff;
      cursor: pointer;
    }

    .header {
      width: 215px;
      height: 27px;
      padding: 0px;
      display: flex;
      flex-direction: row;
      justify-content: flex-start;
      align-items: flex-start;
    }

    .title {
      width: 170px;
      height: 27px;
      padding: 0px;
      display: flex;
      flex-direction: row;
      justify-content: flex-start;
      align-items: flex-start;
      position: relative;
    }

    .title-text {
      text-align: left;
      vertical-align: text-top;
      font-size: 20px;
      font-family: Inter;
      line-height: auto;
      color: #000000;
      cursor: text;
    }

    .icon-delete {
      align-self: flex-start;
      width: 15px;
      height: 6px;
      padding-left: 30px;
      padding-top: 5px;
      display: flex;
      flex-direction: column;
      background-image: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAGCAYAAADKfB7nAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAiSURBVHgB1cshDgAACMPAho/v6YDBI7cmJwtOafWTbiriG677Cve92XguAAAAAElFTkSuQmCC");
      background-position: right;
      background-repeat: no-repeat;
      cursor: default;
    }

    .description {
      width: 207px;
      height: 24px;
      padding-left: 4px;
      padding-right: 4px;
      padding-top: 5px;
      padding-bottom: 5px;
      padding-top: 5px;
      padding-bottom: 5px;
      display: flex;
      flex-direction: row;
      flex-wrap: nowrap;
      justify-content: flex-start;
      align-items: flex-start;
      background-color: #cccccc;
      cursor: text;
    }

    .description-text {
      text-align: left;
      vertical-align: text-top;
      font-size: 16px;
      font-family: Inter;
      align-self: flex-start;
      line-height: auto;
      color: #000000;
    }

    .options {
      width: 205px;
      height: 35px;
      padding-left: 5px;
      padding-right: 5px;
      display: flex;
      flex-direction: row;
      flex-wrap: nowrap;
      justify-content: flex-start;
      align-items: center;
      gap: 5px;
    }

    .option-squarebox {
      width: 20px;
      height: 20px;
      padding: 0px;
      cursor: default;
    }

    .squarebox {
      width: 20px;
      height: 20px;
      background-color: #cccccc;
    }

    .option-timebox {
      align-self: flex-start;
      width: 47px;
      height: 35px;
      padding-left: 3px;
      padding-right: 3px;
      padding-top: 8px;
      display: flex;
      flex-direction: column;
      gap: 10px;
      cursor: text;
    }

    .timebox-text {
      text-align: left;
      vertical-align: text-top;
      font-size: 16px;
      font-family: Inter;
      width: 45px;
      height: 19px;
      line-height: auto;
      color: #000000;
    }

    .option-combobox {
      align-self: flex-start;
      width: 105px;
      height: 35px;
      padding-left: 20px;
      display: flex;
      flex-direction: column;
      gap: 10px;
    }

    .combobox {
      width: 105px;
      height: 33px;
      border-radius: 2px;
      display: flex;
      flex-direction: row;
      justify-content: center;
      align-content: center;
      flex-wrap: wrap;
      gap: 10px;
      background-color: #bbbbbb;
      cursor: default;
    }

    .combobox-text {
      text-align: left;
      vertical-align: text-top;
      font-size: 16px;
      font-family: Inter;
      align-self: flex-start;
      line-height: auto;
      color: #000000;
    }

    .task-body-mask {
      display: none;
      width: 237px;
      height: 758px;
      flex-direction: column;
      gap: 7px;
      overflow: hidden;
    }

    .task-body-mask.visible {
      display: flex;
      position: absolute;
      z-index: 999;
      background-color: #f5f5f5;
    }

    .task-body-mask.dragover {
      background-color: #bbbbbb;
    }

    .task-body-dragging {
      overflow: hidden;
    }

    .task-body-dragging:hover {
      width: 237px;
      overflow: hidden;
    }
  </style>
  <script>
    let dragged;
    let originAncestor;
  </script>
</head>

<body>
  <div class='task-board'></div>
  <script>
    const taskList = ({
      title,
      description
    }) => `
    <div class='task-list'>
      <div class='task-header'>
        <div class='task-headline'>
          <div class='task-headline-title'>
            <div class='task-headline-title-text'>${title}</div>
          </div>
          <div class='icon-vertical-dot'></div>
          </img>
        </div>
        <div class='task-header-description'>
          <div class='task-header-description-text'>${description}</div>
        </div>
      </div>
      <div class='task-body'>
      </div>
    </div>`;
    const task = ({
      title,
      description,
      hour,
      status
    }) => `
    <div class='task' draggable="true">
      <div class='header'>
        <div class='title'>
          <div class='title-text'>${title}</div>
        </div>
        <div class='icon-delete'></div>
      </div>
      <div class='description'>
        <div class='description-text'>${description}</div>
      </div>
      <div class='options'>
        <div class='option-squarebox'>
          <div class='squarebox'></div>
        </div>
        <div class='option-timebox'>
          <div class='timebox-text'>${hour}</div>
        </div>
        <div class='option-combobox'>
          <div class='combobox'>
            <div class='combobox-text'>${status}</div>
          </div>
        </div>
      </div>
    </div>`;

    const taskLists = [taskList({
      title: '월요일',
      description: '등록 시간: 0시간'
    }), taskList({
      title: '화요일',
      description: '등록 시간: 0시간'
    }), taskList({
      title: '수요일',
      description: '등록 시간: 0시간'
    }), taskList({
      title: '목요일',
      description: '등록 시간: 0시간'
    }), taskList({
      title: '금요일',
      description: '등록 시간: 0시간'
    }), taskList({
      title: 'Task',
      description: '등록 시간: 0시간'
    })];

    document.getElementsByClassName('task-board')[0].innerHTML = taskLists.join('');
    Promise.resolve().then(() => {
      const taskLists = document.getElementsByClassName('task-body');
      const taskBodyMask = `<div class="task-body-mask"></div>`;
      const tasks = [task({
        title: 'Task',
        description: 'Task Description',
        hour: '0시간',
        status: '상태'
      }), task({
        title: 'Task',
        description: 'Task Description',
        hour: '0시간',
        status: '상태'
      }), task({
        title: 'Task',
        description: 'Task Description',
        hour: '0시간',
        status: '상태'
      }), task({
        title: 'Task',
        description: 'Task Description',
        hour: '0시간',
        status: '상태'
      }), task({
        title: 'Task',
        description: 'Task Description',
        hour: '0시간',
        status: '상태'
      }), task({
        title: 'Task',
        description: 'Task Description',
        hour: '0시간',
        status: '상태'
      }), task({
        title: 'Task',
        description: 'Task Description',
        hour: '0시간',
        status: '상태'
      })];

      for (const taskList of taskLists) {
        taskList.innerHTML = taskBodyMask + tasks.join('');
      }
    }).then(_ => {
      const taskLists = document.getElementsByClassName('task-body');
      const taskBodyMasks = document.getElementsByClassName('task-body-mask');
      const tasks = [...taskLists].map(taskList => taskList.getElementsByClassName('task'));

      document.addEventListener('dragstart', e => {
        dragged = e.target;
        originAncestor = dragged.closest('.task-body');
        for (const taskBodyMask of taskBodyMasks) {
          const ancestor = taskBodyMask.closest('.task-body');

          if (ancestor !== originAncestor) {
            taskBodyMask.classList.add('visible');
          }
          taskBodyMask.classList.remove("dragover");
        }
        for (const taskList of taskLists) {
          taskList.classList.add('task-body-dragging');
        }
      });

      document.addEventListener('dragend', e => {
        for (const taskBodyMask of taskBodyMasks) {
          taskBodyMask.classList.remove('visible');
        }
        for (const taskList of taskLists) {
          taskList.classList.remove('task-body-dragging');
        }
      });

      document.addEventListener("dragover", e => {
        e.preventDefault();
      }, false);

      document.addEventListener("dragenter", e => {
        if (e.target.classList.contains("task-body-mask")) {
          e.target.classList.add("dragover");
        }
      });

      document.addEventListener("dragleave", e => {
        if (e.target.classList.contains("task-body-mask")) {
          event.target.classList.remove("dragover");
        }
      });

      document.addEventListener('drop', e => {
        e.preventDefault();
        const targetAncestor = e.target.closest('.task-body');
        if (e.target.className.includes('task-body-mask')) {
          targetAncestor.appendChild(dragged);
        }
      });
    })
  </script>
</body>

</html>